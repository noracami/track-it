{% extends "base.html" %}
{% block hey %}
    <div class="row">
        <div class="col-md-8">
            <h2>{{ issue_get.title }} <span style="color:#aaa">#{{ issue_get.id }}</span></h2>
        </div>
    </div>
    {% if issue_get.status %}
    {# is close? #}
    {# yes #}
    <div style="float: left;">
        <h4><span class="label label-danger"><span class="glyphicon glyphicon-exclamation-sign" aria-hidden="true"></span> Closed</span></h4>
    </div>
    {% else %}
    {# no #}
    <div style="float: left;">
        <h4><span class="label label-success"><span class="glyphicon glyphicon-exclamation-sign" aria-hidden="true"></span> Open</span></h4>
    </div>
    {% endif %}
    <div><h4></h4>&nbsp;&nbsp;<a href="/users/{{ opened_user.account.id }}">{{ opened_user.account }}</a> opened this issue on {{ issue_get.time|date:"Y/m/d H:i:s" }} · 0 comments</div>
    <div class="row"></div>
    <hr>
    <div class="comment-wraper">
        {% for c in issue_get.comment %}
        <div class="row-message">
            <div class="media">
                <div class="media-left media-top">
                    <a href="#">
                        <img class="media-object" src="http://placehold.it/60x60" alt="...">
                    </a>
                </div>
                <div class="media-body">
                    <div class="panel panel-default">
                        <div class="panel-heading container-fluid">
                            <h3 class="panel-title" style="float: left;"><a href="/users/{{ c.user.id }}">{{ c.user.name }} (@{{ c.user.account }})</a> commented on {{ c.time|date:"Y/m/d H:i:s" }}</h3>
                            <span class="pull-right badge">{{ c.user.member }}</span>
                        </div>
                        <div class="panel-body">
                            {% if c.content %}
                            {{c.content}}
                            {% else %}
                            <i>No description provided.</i>
                            {% endif %}
                        </div>
                    </div>
                </div>
            </div>
        </div>
        {% endfor %}
    </div>
    <hr>
    <div class="comment-wraper">
        <div class="row-message">
            <div class="media">
                <div class="media-left media-top">
                    <a href="#">
                        <img class="media-object" src="http://placehold.it/60x60" alt="...">
                    </a>
                </div>
                <div class="media-body">
                    <div class="panel-default panel">
                        <form name="form_newcomment" action="{% url 'add' %}" method="POST">
                            {% csrf_token %}
                            <input type="hidden" name="todo" value="newcomment">
                            <input type="hidden" name="issue_id" value="{{ issue_get.id }}">
                            <div class="panel-body">
                                <div class="form-group">
                                    <textarea class="form-control form-required" placeholder="Leave a comment" name="comment" id="comment01" style="resize:none" cols="30" rows="6"></textarea>
                                </div>
                                <button id="submit01" type="submit" class="btn btn-success pull-right disabled">
                                    <span class="glyphicon glyphicon-pencil" aria-hidden="true"></span> 送出
                                </button>
                            </div>
                        </form>
                    </div>
                </div>
            </div>
        </div>
    </div>
{% endblock %}
{% block customjs %}
<script>
    $(".form-required").on("change", function(){
        /* Do something... */
        var isValid = true;
        $('.form-required').each(function(){
            if ($(this).val() === '')
                isValid = false;
        });
        if (isValid)
            $("#submit01").removeClass("disabled");
        else
            $("#submit01").addClass("disabled");
    });
</script>
{% endblock %}